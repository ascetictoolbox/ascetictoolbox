2016-08-17 16:21:54,230 - [INFO] - from play in pool-4-thread-1 
Listening for HTTP on /0:0:0:0:0:0:0:0:9000

2016-08-17 16:21:55,947 - [INFO] - from application in play-internal-execution-context-1 
Connecting to mongodb://localhost:27017/applicationmonitor

2016-08-17 16:21:56,151 - [INFO] - from application in play-internal-execution-context-1 
Initiating Message Queue Manager...

2016-08-17 16:21:56,152 - [WARN] - from application in play-internal-execution-context-1 
Restarting Message Queue connection

2016-08-17 16:21:56,152 - [DEBUG] - from application in play-internal-execution-context-1 
Stopped previously stablished connection, if any

2016-08-17 16:21:56,959 - [DEBUG] - from application in Thread-4 
Starting PeriodicNotificationSender thread

2016-08-17 16:21:56,962 - [INFO] - from application in play-internal-execution-context-1 
Message Queue Manager Sucessfully created...

2016-08-17 16:21:56,977 - [INFO] - from application in Thread-5 
Initializing Estimations Reader thread

2016-08-17 16:21:58,010 - [DEBUG] - from play in play-internal-execution-context-1 
Plugin [play.api.db.BoneCPPlugin] is disabled

2016-08-17 16:21:58,017 - [DEBUG] - from play in play-internal-execution-context-1 
Plugin [play.api.db.evolutions.EvolutionsPlugin] is disabled

2016-08-17 16:21:58,504 - [INFO] - from play in play-internal-execution-context-1 
Application started (Dev)

2016-08-17 16:21:58,864 - [INFO] - from akka.event.slf4j.Slf4jLogger in play-akka.actor.default-dispatcher-2 
Slf4jLogger started

2016-08-17 16:21:59,043 - [INFO] - from application in play-akka.actor.default-dispatcher-6 
Creating collection 'appdeployments'...

2016-08-17 16:21:59,091 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Opened connection [connectionId{localValue:2, serverValue:19}] to localhost:27017

2016-08-17 16:21:59,347 - [INFO] - from application in play-akka.actor.default-dispatcher-3 
Creating collection 'events'...

2016-08-17 16:21:59,369 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-3 
Opened connection [connectionId{localValue:4, serverValue:21}] to localhost:27017

2016-08-17 16:21:59,440 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Opened connection [connectionId{localValue:3, serverValue:20}] to localhost:27017

2016-08-17 16:22:13,182 - [DEBUG] - from application in Thread-3 
received message: {"Command":"initiateMonitoring", "ApplicationId":"SinusApp","slaId":"xxx","Terms":["metric"],"Frequency":10000}

2016-08-17 16:22:24,077 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:22:24,077 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443734077
 AND timestamp <= 1471443744077 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:22:24,181 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":9.575944775422624}]

2016-08-17 16:22:24,182 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443744182,"Terms":{"_id":null,"metric":9.575944775422624}}

2016-08-17 16:22:34,274 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:22:34,275 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443744275
 AND timestamp <= 1471443754275 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:22:34,282 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":9.929597656670811}]

2016-08-17 16:22:34,283 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443754283,"Terms":{"_id":null,"metric":9.929597656670811}}

2016-08-17 16:22:44,333 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:22:44,333 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443754333
 AND timestamp <= 1471443764333 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:22:44,338 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":10.090651011891635}]

2016-08-17 16:22:44,338 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443764338,"Terms":{"_id":null,"metric":10.090651011891635}}

2016-08-17 16:22:54,372 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:22:54,374 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443764374
 AND timestamp <= 1471443774374 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:22:54,378 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":9.54114056429249}]

2016-08-17 16:22:54,378 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443774378,"Terms":{"_id":null,"metric":9.54114056429249}}

2016-08-17 16:23:04,419 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:04,419 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443774419
 AND timestamp <= 1471443784419 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:04,423 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":9.148610694109744}]

2016-08-17 16:23:04,423 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443784423,"Terms":{"_id":null,"metric":9.148610694109744}}

2016-08-17 16:23:14,465 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:14,465 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443784465
 AND timestamp <= 1471443794465 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:14,470 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":8.10953391460953}]

2016-08-17 16:23:14,470 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443794470,"Terms":{"_id":null,"metric":8.10953391460953}}

2016-08-17 16:23:24,512 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:24,514 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443794514
 AND timestamp <= 1471443804514 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:24,519 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":6.919668806926838}]

2016-08-17 16:23:24,519 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443804519,"Terms":{"_id":null,"metric":6.919668806926838}}

2016-08-17 16:23:34,561 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:34,562 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443804562
 AND timestamp <= 1471443814562 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:34,566 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":5.810243922832492}]

2016-08-17 16:23:34,566 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443814566,"Terms":{"_id":null,"metric":5.810243922832492}}

2016-08-17 16:23:44,608 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:44,609 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443814609
 AND timestamp <= 1471443824609 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:44,614 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":4.5816700554399565}]

2016-08-17 16:23:44,614 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443824614,"Terms":{"_id":null,"metric":4.5816700554399565}}

2016-08-17 16:23:54,658 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:23:54,659 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443824659
 AND timestamp <= 1471443834659 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:23:54,662 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":3.19045150119353}]

2016-08-17 16:23:54,663 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443834662,"Terms":{"_id":null,"metric":3.19045150119353}}

2016-08-17 16:24:04,216 - [WARN] - from application in Thread-3 
Error dispatching messages: Transport connection remotely closed.

2016-08-17 16:24:04,216 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:04,216 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:04,218 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:04,241 - [ERROR] - from application in Thread-3 
Cannot send to a non-connected transport.
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:78) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:04,704 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:24:04,705 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443834705
 AND timestamp <= 1471443844705 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:24:04,709 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":2.210309363639779}]

2016-08-17 16:24:04,710 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443844710,"Terms":{"_id":null,"metric":2.210309363639779}}

2016-08-17 16:24:04,712 - [WARN] - from application in Thread-4 
Error sending notification: Error sending notification: The Session was closed due to an unrecoverable error.
es.bsc.amon.mq.notif.PeriodicNotificationException: Error sending notification: The Session was closed due to an unrecoverable error.
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:215) ~[na:na]
	at es.bsc.amon.mq.MQManager$PeriodicNotificationSender.run(MQManager.java:212) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: javax.jms.IllegalStateException: The Session was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsSession.checkClosed(JmsSession.java:772) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsSession.createTextMessage(JmsSession.java:539) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:208) ~[na:na]
	... 2 common frames omitted
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:04,713 - [WARN] - from application in Thread-4 
Restarting Message Queue connection

2016-08-17 16:24:04,713 - [DEBUG] - from application in Thread-4 
Stopped previously stablished connection, if any

2016-08-17 16:24:04,717 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-4 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:04,912 - [WARN] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Got socket exception on connection [connectionId{localValue:3, serverValue:20}] to localhost:27017. All connections to localhost:27017 will be closed.

2016-08-17 16:24:04,915 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Closed connection [connectionId{localValue:3, serverValue:20}] to localhost:27017 because there was a socket exception raised on another connection from this pool.

2016-08-17 16:24:04,918 - [ERROR] - from play in play-akka.actor.default-dispatcher-6 
Cannot invoke the action, eventually got an error: com.mongodb.MongoSocketReadException: Prematurely reached end of stream

2016-08-17 16:24:04,920 - [INFO] - from org.mongodb.driver.cluster in cluster-ClusterId{value='57b473040476172316fde1ff', description='null'}-localhost:27017 
Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:114) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:127) ~[mongo-java-driver-3.0.1.jar:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_77]
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~[na:1.8.0_77]
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~[na:1.8.0_77]
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~[na:1.8.0_77]
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.8.0_77]
	at java.net.Socket.connect(Socket.java:589) ~[na:1.8.0_77]
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58) ~[mongo-java-driver-3.0.1.jar:na]
	... 3 common frames omitted

2016-08-17 16:24:04,953 - [ERROR] - from application in play-akka.actor.default-dispatcher-6 


! @7156ei28d - Internal server error, for (POST) [/event] ->

play.api.Application$$anon$1: Execution exception[[MongoSocketReadException: Prematurely reached end of stream]]
	at play.api.Application$class.handleError(Application.scala:296) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.DefaultApplication.handleError(Application.scala:402) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:316) [play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32) [scala-library-2.11.1.jar:na]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Promise$class.complete(Promise.scala:55) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:23) [scala-library-2.11.1.jar:na]
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41) [akka-actor_2.11-2.3.3.jar:na]
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:393) [akka-actor_2.11-2.3.3.jar:na]
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [scala-library-2.11.1.jar:na]
Caused by: com.mongodb.MongoSocketReadException: Prematurely reached end of stream
	at com.mongodb.connection.SocketStream.read(SocketStream.java:88) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:491) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveMessage(InternalStreamConnection.java:221) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.UsageTrackingInternalConnection.receiveMessage(UsageTrackingInternalConnection.java:102) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultConnectionPool$PooledConnection.receiveMessage(DefaultConnectionPool.java:416) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.WriteCommandProtocol.receiveMessage(WriteCommandProtocol.java:184) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.WriteCommandProtocol.execute(WriteCommandProtocol.java:76) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InsertCommandProtocol.execute(InsertCommandProtocol.java:66) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InsertCommandProtocol.execute(InsertCommandProtocol.java:37) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServer$DefaultServerProtocolExecutor.execute(DefaultServer.java:155) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServerConnection.executeProtocol(DefaultServerConnection.java:219) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServerConnection.insertCommand(DefaultServerConnection.java:108) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.InsertOperation.executeCommandProtocol(InsertOperation.java:76) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation$1.call(BaseWriteOperation.java:111) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation$1.call(BaseWriteOperation.java:106) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnectionSource(OperationHelper.java:186) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:177) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:106) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:58) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:745) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:728) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.executeWriteOperation(DBCollection.java:327) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:323) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:314) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:284) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:250) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:172) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:392) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:367) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.controller.EventsDBMapper.storeEvent(EventsDBMapper.java:101) ~[classes/:na]
	at http.Events.post(Events.java:31) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at play.core.Router$HandlerInvokerFactory$$anon$4.resultCall(Router.scala:264) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.invocation(Router.scala:255) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:55) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.GlobalSettings$1.call(GlobalSettings.java:67) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:40) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:32) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$.apply(Future.scala:31) ~[scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$.apply(Future.scala:492) ~[scala-library-2.11.1.jar:na]
	at play.core.j.JavaAction$class.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.apply(Router.scala:252) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.utils.Threads$.withContextClassLoader(Threads.scala:21) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:129) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:121) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	... 6 common frames omitted

2016-08-17 16:24:05,979 - [INFO] - from org.mongodb.driver.cluster in play-akka.actor.default-dispatcher-6 
No server chosen by PrimaryServerSelector from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:07,221 - [WARN] - from application in Thread-5 
Transport connection remotely closed.
javax.jms.JMSException: Transport connection remotely closed.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.dequeue(JmsMessageConsumer.java:244) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:192) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:07,225 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:07,228 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:07,790 - [INFO] - from org.mongodb.driver.cluster in play-akka.actor.default-dispatcher-4 
No server chosen by ReadPreferenceServerSelector{readPreference=primary} from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:07,822 - [INFO] - from org.mongodb.driver.cluster in play-akka.actor.default-dispatcher-3 
No server chosen by ReadPreferenceServerSelector{readPreference=primary} from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:10,230 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:10,236 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:10,238 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:13,244 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:13,248 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:13,250 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:14,244 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:24:14,245 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:14,246 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:14,246 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:14,250 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-3 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:14,251 - [ERROR] - from application in Thread-3 
Connection refused: localhost/127.0.0.1:5672
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:14,722 - [ERROR] - from application in Thread-4 
Error restarting connection: Error sending notification: The Session was closed due to an unrecoverable error.
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$PeriodicNotificationSender.run(MQManager.java:216) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:15,724 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:24:15,724 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443845724
 AND timestamp <= 1471443855724 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:24:15,726 - [INFO] - from org.mongodb.driver.cluster in Thread-4 
No server chosen by ReadPreferenceServerSelector{readPreference=primary} from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:16,256 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:16,260 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:16,261 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:19,233 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(3):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::bb62d131-82a2-4ffc-8bdf-875ae11b2dbb:1, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::bb62d131-82a2-4ffc-8bdf-875ae11b2dbb:1 } timed out

2016-08-17 16:24:19,267 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:19,271 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:19,273 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:22,278 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:22,283 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:22,284 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:24,256 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:24:24,256 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:24,256 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:24,256 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:24,262 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-3 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:24,264 - [ERROR] - from application in Thread-3 
Connection refused: localhost/127.0.0.1:5672
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:25,290 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:25,294 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:25,295 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:28,299 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:28,302 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:28,303 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:31,306 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:31,309 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:31,310 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:34,267 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:24:34,268 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:34,269 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:34,269 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:34,272 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-3 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:34,274 - [ERROR] - from application in Thread-3 
Connection refused: localhost/127.0.0.1:5672
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:34,314 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:34,317 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:34,318 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:35,982 - [ERROR] - from play in play-akka.actor.default-dispatcher-6 
Cannot invoke the action, eventually got an error: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]

2016-08-17 16:24:35,992 - [ERROR] - from application in play-akka.actor.default-dispatcher-6 


! @7156ejm6b - Internal server error, for (POST) [/event] ->

play.api.Application$$anon$1: Execution exception[[MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]]]
	at play.api.Application$class.handleError(Application.scala:296) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.DefaultApplication.handleError(Application.scala:402) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:316) [play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32) [scala-library-2.11.1.jar:na]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Promise$class.complete(Promise.scala:55) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:23) [scala-library-2.11.1.jar:na]
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41) [akka-actor_2.11-2.3.3.jar:na]
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:393) [akka-actor_2.11-2.3.3.jar:na]
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [scala-library-2.11.1.jar:na]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getWriteConnectionSource(ClusterBinding.java:68) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:175) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:106) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:58) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:745) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:728) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.executeWriteOperation(DBCollection.java:327) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:323) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:314) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:284) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:250) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:172) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:392) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:367) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.controller.EventsDBMapper.storeEvent(EventsDBMapper.java:101) ~[classes/:na]
	at http.Events.post(Events.java:31) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at play.core.Router$HandlerInvokerFactory$$anon$4.resultCall(Router.scala:264) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.invocation(Router.scala:255) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:55) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.GlobalSettings$1.call(GlobalSettings.java:67) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:40) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:32) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$.apply(Future.scala:31) ~[scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$.apply(Future.scala:492) ~[scala-library-2.11.1.jar:na]
	at play.core.j.JavaAction$class.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.apply(Router.scala:252) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.utils.Threads$.withContextClassLoader(Threads.scala:21) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:129) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:121) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	... 6 common frames omitted

2016-08-17 16:24:37,007 - [INFO] - from org.mongodb.driver.cluster in play-akka.actor.default-dispatcher-6 
No server chosen by PrimaryServerSelector from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:37,319 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:37,329 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:37,330 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:37,792 - [ERROR] - from play in play-akka.actor.default-dispatcher-4 
Cannot invoke the action, eventually got an error: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]

2016-08-17 16:24:37,797 - [ERROR] - from application in play-akka.actor.default-dispatcher-4 


! @7156ejonm - Internal server error, for (GET) [/apps?start=-300000] ->

play.api.Application$$anon$1: Execution exception[[MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]]]
	at play.api.Application$class.handleError(Application.scala:296) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.DefaultApplication.handleError(Application.scala:402) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:316) [play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32) [scala-library-2.11.1.jar:na]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Promise$class.complete(Promise.scala:55) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:23) [scala-library-2.11.1.jar:na]
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41) [akka-actor_2.11-2.3.3.jar:na]
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:393) [akka-actor_2.11-2.3.3.jar:na]
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [scala-library-2.11.1.jar:na]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getReadConnectionSource(ClusterBinding.java:63) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:166) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.FindOperation.execute(FindOperation.java:394) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.FindOperation.execute(FindOperation.java:57) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:736) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:723) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCursor.initializeCursor(DBCursor.java:815) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCursor.hasNext(DBCursor.java:149) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.DBManager.find(DBManager.java:105) ~[classes/:na]
	at es.bsc.amon.DBManager.find(DBManager.java:81) ~[classes/:na]
	at es.bsc.amon.controller.AppsDBMapper.getAllApps(AppsDBMapper.java:101) ~[classes/:na]
	at http.Apps.listApps(Apps.java:42) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$7$$anonfun$apply$7.apply(routes_routing.scala:240) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$7$$anonfun$apply$7.apply(routes_routing.scala:240) ~[classes/:na]
	at play.core.Router$HandlerInvokerFactory$$anon$4.resultCall(Router.scala:264) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.invocation(Router.scala:255) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:55) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.GlobalSettings$1.call(GlobalSettings.java:67) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:40) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:32) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$.apply(Future.scala:31) ~[scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$.apply(Future.scala:492) ~[scala-library-2.11.1.jar:na]
	at play.core.j.JavaAction$class.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.apply(Router.scala:252) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.utils.Threads$.withContextClassLoader(Threads.scala:21) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:129) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:121) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	... 6 common frames omitted

2016-08-17 16:24:37,825 - [ERROR] - from play in play-akka.actor.default-dispatcher-3 
Cannot invoke the action, eventually got an error: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]

2016-08-17 16:24:37,830 - [ERROR] - from application in play-akka.actor.default-dispatcher-3 


! @7156ejop3 - Internal server error, for (GET) [/apps/finished?limit=12] ->

play.api.Application$$anon$1: Execution exception[[MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]]]
	at play.api.Application$class.handleError(Application.scala:296) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.DefaultApplication.handleError(Application.scala:402) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:316) [play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32) [scala-library-2.11.1.jar:na]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Promise$class.complete(Promise.scala:55) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:23) [scala-library-2.11.1.jar:na]
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41) [akka-actor_2.11-2.3.3.jar:na]
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:393) [akka-actor_2.11-2.3.3.jar:na]
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [scala-library-2.11.1.jar:na]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getReadConnectionSource(ClusterBinding.java:63) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:166) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.FindOperation.execute(FindOperation.java:394) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.FindOperation.execute(FindOperation.java:57) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:736) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:723) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCursor.initializeCursor(DBCursor.java:815) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCursor.hasNext(DBCursor.java:149) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.DBManager.find(DBManager.java:105) ~[classes/:na]
	at es.bsc.amon.controller.AppsDBMapper.getFinishedAppDeployments(AppsDBMapper.java:146) ~[classes/:na]
	at http.Apps.listFinishedDeployments(Apps.java:80) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$10$$anonfun$apply$10.apply(routes_routing.scala:264) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$10$$anonfun$apply$10.apply(routes_routing.scala:264) ~[classes/:na]
	at play.core.Router$HandlerInvokerFactory$$anon$4.resultCall(Router.scala:264) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.invocation(Router.scala:255) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:55) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.GlobalSettings$1.call(GlobalSettings.java:67) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:40) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:32) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$.apply(Future.scala:31) ~[scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$.apply(Future.scala:492) ~[scala-library-2.11.1.jar:na]
	at play.core.j.JavaAction$class.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.apply(Router.scala:252) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.utils.Threads$.withContextClassLoader(Threads.scala:21) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:129) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:121) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	... 6 common frames omitted

2016-08-17 16:24:40,334 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:40,336 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:40,338 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:43,339 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:43,343 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:43,344 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:44,275 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:24:44,276 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:44,276 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:44,276 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:44,279 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-3 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:44,280 - [ERROR] - from application in Thread-3 
Connection refused: localhost/127.0.0.1:5672
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:45,728 - [WARN] - from application in Thread-4 
Error sending notification: Error sending notification: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
es.bsc.amon.mq.notif.PeriodicNotificationException: Error sending notification: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:215) ~[na:na]
	at es.bsc.amon.mq.MQManager$PeriodicNotificationSender.run(MQManager.java:212) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getReadConnectionSource(ClusterBinding.java:63) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:166) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.AggregateOperation.execute(AggregateOperation.java:196) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.AggregateOperation.execute(AggregateOperation.java:62) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:736) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:723) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1329) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1262) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1248) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.controller.EventsDBMapper.aggregate(EventsDBMapper.java:197) ~[na:na]
	at es.bsc.amon.controller.QueriesDBMapper.aggregateFromJsonStr(QueriesDBMapper.java:61) ~[na:na]
	at es.bsc.amon.controller.QueriesDBMapper.aggregate(QueriesDBMapper.java:51) ~[na:na]
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:164) ~[na:na]
	... 2 common frames omitted

2016-08-17 16:24:45,729 - [WARN] - from application in Thread-4 
Restarting Message Queue connection

2016-08-17 16:24:45,729 - [DEBUG] - from application in Thread-4 
Stopped previously stablished connection, if any

2016-08-17 16:24:45,732 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-4 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:46,349 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:46,351 - [ERROR] - from org.apache.qpid.jms.JmsConnectionFactory in Thread-5 
Failed to create JMS Provider instance for: amqp

2016-08-17 16:24:46,352 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:87) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:48,209 - [INFO] - from org.mongodb.driver.cluster in cluster-ClusterId{value='57b473040476172316fde1ff', description='null'}-localhost:27017 
Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketReadException: Prematurely reached end of stream
	at com.mongodb.connection.SocketStream.read(SocketStream.java:88) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:491) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveMessage(InternalStreamConnection.java:221) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.receiveReply(CommandHelper.java:134) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.receiveCommandResult(CommandHelper.java:121) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.executeCommand(CommandHelper.java:32) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnectionInitializer.initializeConnectionDescription(InternalStreamConnectionInitializer.java:83) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnectionInitializer.initialize(InternalStreamConnectionInitializer.java:43) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:127) ~[mongo-java-driver-3.0.1.jar:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]

2016-08-17 16:24:49,357 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:49,378 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:52,384 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:52,398 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Transport connection remotely closed.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:54,285 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:24:54,286 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:24:54,286 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:24:54,286 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:24:54,317 - [ERROR] - from application in Thread-3 
Cannot send to a non-connected transport.
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:78) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:55,405 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:55,416 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:55,739 - [ERROR] - from application in Thread-4 
Error restarting connection: Error sending notification: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
javax.jms.JMSException: Connection refused: localhost/127.0.0.1:5672
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:155) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnectionFactory.createTopicConnection(JmsConnectionFactory.java:144) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:77) ~[na:na]
	at es.bsc.amon.mq.MQManager$PeriodicNotificationSender.run(MQManager.java:216) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.net.ConnectException: Connection refused: localhost/127.0.0.1:5672
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_77]
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_77]
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:191) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:279) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:461) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:378) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:350) ~[netty-transport-4.0.17.Final.jar:4.0.17.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:101) ~[netty-common-4.0.17.Final.jar:4.0.17.Final]
	... 1 common frames omitted

2016-08-17 16:24:56,744 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:24:56,745 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443886745
 AND timestamp <= 1471443896745 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:24:56,748 - [INFO] - from org.mongodb.driver.cluster in Thread-4 
No server chosen by ReadPreferenceServerSelector{readPreference=primary} from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:24:58,420 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:24:58,430 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:01,435 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:01,446 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:04,321 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:25:04,322 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:25:04,322 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:25:04,322 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:25:04,380 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(4):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::8570aa1f-26be-4966-aa63-fa05d153e28d:16, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::8570aa1f-26be-4966-aa63-fa05d153e28d:16 } timed out

2016-08-17 16:25:04,447 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:04,755 - [ERROR] - from application in Thread-3 
Transport connection remotely closed.
javax.jms.JMSException: Transport connection remotely closed.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:78) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:04,755 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Transport connection remotely closed.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:07,009 - [ERROR] - from play in play-akka.actor.default-dispatcher-6 
Cannot invoke the action, eventually got an error: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]

2016-08-17 16:25:07,016 - [ERROR] - from application in play-akka.actor.default-dispatcher-6 


! @7156elg3g - Internal server error, for (POST) [/event] ->

play.api.Application$$anon$1: Execution exception[[MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]]]
	at play.api.Application$class.handleError(Application.scala:296) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.DefaultApplication.handleError(Application.scala:402) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3$$anonfun$applyOrElse$4.apply(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:320) [play_2.11-2.3.1.jar:2.3.1]
	at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$3.applyOrElse(PlayDefaultUpstreamHandler.scala:316) [play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32) [scala-library-2.11.1.jar:na]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248) [scala-library-2.11.1.jar:na]
	at scala.concurrent.Promise$class.complete(Promise.scala:55) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:23) [scala-library-2.11.1.jar:na]
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41) [akka-actor_2.11-2.3.3.jar:na]
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:393) [akka-actor_2.11-2.3.3.jar:na]
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [scala-library-2.11.1.jar:na]
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [scala-library-2.11.1.jar:na]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches PrimaryServerSelector. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getWriteConnectionSource(ClusterBinding.java:68) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:175) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:106) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.BaseWriteOperation.execute(BaseWriteOperation.java:58) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:745) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:728) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.executeWriteOperation(DBCollection.java:327) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:323) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:314) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:284) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:250) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.insert(DBCollection.java:172) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:392) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.save(DBCollection.java:367) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.controller.EventsDBMapper.storeEvent(EventsDBMapper.java:101) ~[classes/:na]
	at http.Events.post(Events.java:31) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at Routes$$anonfun$routes$1$$anonfun$applyOrElse$13$$anonfun$apply$13.apply(routes_routing.scala:288) ~[classes/:na]
	at play.core.Router$HandlerInvokerFactory$$anon$4.resultCall(Router.scala:264) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.invocation(Router.scala:255) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:55) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.GlobalSettings$1.call(GlobalSettings.java:67) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.j.JavaAction$$anonfun$11.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:40) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Execution$trampoline$.execute(Execution.scala:46) [play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:32) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$.apply(Future.scala:31) ~[scala-library-2.11.1.jar:na]
	at scala.concurrent.Future$.apply(Future.scala:492) ~[scala-library-2.11.1.jar:na]
	at play.core.j.JavaAction$class.apply(JavaAction.scala:82) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.core.Router$HandlerInvokerFactory$JavaActionInvokerFactory$$anon$15$$anon$1.apply(Router.scala:252) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4$$anonfun$apply$5.apply(Action.scala:130) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.utils.Threads$.withContextClassLoader(Threads.scala:21) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:129) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1$$anonfun$apply$4.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at scala.Option.map(Option.scala:145) [scala-library-2.11.1.jar:na]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:128) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.mvc.Action$$anonfun$apply$1.apply(Action.scala:121) ~[play_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$mapM$1.apply(Iteratee.scala:483) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMapM$1.apply(Iteratee.scala:519) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at play.api.libs.iteratee.Iteratee$$anonfun$flatMap$1$$anonfun$apply$14.apply(Iteratee.scala:496) ~[play-iteratees_2.11-2.3.1.jar:2.3.1]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24) [scala-library-2.11.1.jar:na]
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24) [scala-library-2.11.1.jar:na]
	... 6 common frames omitted

2016-08-17 16:25:07,397 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(5):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::2113a027-dc71-46d9-b4fd-342d2a3f0871:17, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::2113a027-dc71-46d9-b4fd-342d2a3f0871:17 } timed out

2016-08-17 16:25:07,758 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:07,768 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:08,035 - [INFO] - from org.mongodb.driver.cluster in play-akka.actor.default-dispatcher-6 
No server chosen by PrimaryServerSelector from cluster description ClusterDescription{type=UNKNOWN, connectionMode=SINGLE, all=[ServerDescription{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]}. Waiting for 30000 ms before timing out

2016-08-17 16:25:09,316 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(6):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::412a5cf5-5d38-4f84-bfa2-c5f291460583:1, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::412a5cf5-5d38-4f84-bfa2-c5f291460583:1 } timed out

2016-08-17 16:25:10,418 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(7):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::f2f02ee5-9bda-45b3-b6d5-81de2f7b7e2e:18, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::f2f02ee5-9bda-45b3-b6d5-81de2f7b7e2e:18 } timed out

2016-08-17 16:25:10,772 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:10,781 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:13,428 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(8):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::6bc68814-f214-4873-b283-70675e125d8e:19, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::6bc68814-f214-4873-b283-70675e125d8e:19 } timed out

2016-08-17 16:25:13,784 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:13,792 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:14,760 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:25:14,760 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:25:14,760 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:25:14,760 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:25:14,771 - [ERROR] - from application in Thread-3 
Cannot send to a non-connected transport.
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.MQManager.restartConnection(MQManager.java:78) ~[na:na]
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:160) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:16,446 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(9):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::a786ea77-47bd-4cd4-85e6-c462c257aad2:20, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::a786ea77-47bd-4cd4-85e6-c462c257aad2:20 } timed out

2016-08-17 16:25:16,798 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:16,830 - [ERROR] - from application in Thread-5 
Error reconnecting from estimations reader
javax.jms.JMSException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:66) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:88) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:548) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:532) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.connect(JmsConnection.java:447) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsConnection.start(JmsConnection.java:301) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:88) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Cannot send to a non-connected transport.
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.checkConnected(NettyTcpTransport.java:296) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.transports.netty.NettyTcpTransport.allocateSendBuffer(NettyTcpTransport.java:188) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider.pumpToProtonTransport(AmqpProvider.java:867) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$4.run(AmqpProvider.java:343) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:19,331 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(10):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::d844405a-c098-4318-ad83-0c32b2f4f3f6:1, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::d844405a-c098-4318-ad83-0c32b2f4f3f6:1 } timed out

2016-08-17 16:25:19,456 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(11):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::54070a26-b811-4004-9fa8-c6aca75b37f5:21, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::54070a26-b811-4004-9fa8-c6aca75b37f5:21 } timed out

2016-08-17 16:25:19,834 - [WARN] - from application in Thread-5 
The MessageConsumer was closed due to an unrecoverable error.
javax.jms.IllegalStateException: The MessageConsumer was closed due to an unrecoverable error.
	at org.apache.qpid.jms.JmsMessageConsumer.checkClosed(JmsMessageConsumer.java:318) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at org.apache.qpid.jms.JmsMessageConsumer.receive(JmsMessageConsumer.java:184) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at es.bsc.amon.mq.dispatch.AppEstimationsReader$1.run(AppEstimationsReader.java:48) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: java.io.IOException: Transport connection remotely closed.
	at org.apache.qpid.jms.provider.amqp.AmqpProvider$19.run(AmqpProvider.java:749) ~[qpid-jms-client-0.9.0.jar:0.9.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_77]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_77]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_77]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_77]
	... 1 common frames omitted

2016-08-17 16:25:22,770 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(12):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::74f6f0cc-f54e-47e3-959a-6658b32cd30f:22, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::74f6f0cc-f54e-47e3-959a-6658b32cd30f:22 } timed out

2016-08-17 16:25:24,775 - [WARN] - from application in Thread-3 
Error dispatching messages: The MessageConsumer was closed due to an unrecoverable error.

2016-08-17 16:25:24,776 - [WARN] - from application in Thread-3 
Reconnecting to the MQ

2016-08-17 16:25:24,776 - [WARN] - from application in Thread-3 
Restarting Message Queue connection

2016-08-17 16:25:24,776 - [DEBUG] - from application in Thread-3 
Stopped previously stablished connection, if any

2016-08-17 16:25:25,783 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(13):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::83e61e84-854b-4195-814a-895c122cf863:23, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::83e61e84-854b-4195-814a-895c122cf863:23 } timed out

2016-08-17 16:25:26,751 - [WARN] - from application in Thread-4 
Error sending notification: Error sending notification: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]
es.bsc.amon.mq.notif.PeriodicNotificationException: Error sending notification: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:215) ~[na:na]
	at es.bsc.amon.mq.MQManager$PeriodicNotificationSender.run(MQManager.java:212) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]
Caused by: com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting for a server that matches ReadPreferenceServerSelector{readPreference=primary}. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketReadException: Prematurely reached end of stream}}]
	at com.mongodb.connection.BaseCluster.createTimeoutException(BaseCluster.java:370) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.BaseCluster.selectServer(BaseCluster.java:101) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:75) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding$ClusterBindingConnectionSource.<init>(ClusterBinding.java:71) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.binding.ClusterBinding.getReadConnectionSource(ClusterBinding.java:63) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.OperationHelper.withConnection(OperationHelper.java:166) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.AggregateOperation.execute(AggregateOperation.java:196) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.operation.AggregateOperation.execute(AggregateOperation.java:62) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo.execute(Mongo.java:736) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.Mongo$2.execute(Mongo.java:723) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1329) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1262) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.DBCollection.aggregate(DBCollection.java:1248) ~[mongo-java-driver-3.0.1.jar:na]
	at es.bsc.amon.controller.EventsDBMapper.aggregate(EventsDBMapper.java:197) ~[na:na]
	at es.bsc.amon.controller.QueriesDBMapper.aggregateFromJsonStr(QueriesDBMapper.java:61) ~[na:na]
	at es.bsc.amon.controller.QueriesDBMapper.aggregate(QueriesDBMapper.java:51) ~[na:na]
	at es.bsc.amon.mq.dispatch.AppMeasuresNotifier.sendNotification(AppMeasuresNotifier.java:164) ~[na:na]
	... 2 common frames omitted

2016-08-17 16:25:26,751 - [WARN] - from application in Thread-4 
Restarting Message Queue connection

2016-08-17 16:25:26,751 - [DEBUG] - from application in Thread-4 
Another process is restarting it. Exiting

2016-08-17 16:25:28,793 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(14):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::f723cb56-b067-4010-bd4e-869d2c4842ed:24, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::f723cb56-b067-4010-bd4e-869d2c4842ed:24 } timed out

2016-08-17 16:25:29,769 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(15):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::c651e1b2-82f4-4412-acdf-8de26df3305b:1, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::c651e1b2-82f4-4412-acdf-8de26df3305b:1 } timed out

2016-08-17 16:25:31,372 - [INFO] - from org.apache.qpid.jms.sasl.SaslMechanismFinder in AmqpProvider:(18):[amqp://localhost:5672] 
Best match for SASL auth was: SASL-ANONYMOUS

2016-08-17 16:25:31,372 - [INFO] - from org.apache.qpid.jms.sasl.SaslMechanismFinder in AmqpProvider:(17):[amqp://localhost:5672] 
Best match for SASL auth was: SASL-ANONYMOUS

2016-08-17 16:25:31,557 - [INFO] - from org.apache.qpid.jms.JmsConnection in AmqpProvider:(17):[amqp://localhost:5672] 
Connection ID::0eb563bb-3ce3-4b99-857e-f6d9d2ccc1b0:26 connected to remote Broker: amqp://localhost:5672

2016-08-17 16:25:31,557 - [INFO] - from org.apache.qpid.jms.JmsConnection in AmqpProvider:(18):[amqp://localhost:5672] 
Connection ID::a0631829-1800-4ef0-80fe-25505c04bcd5:1 connected to remote Broker: amqp://localhost:5672

2016-08-17 16:25:31,832 - [WARN] - from org.apache.qpid.jms.provider.amqp.builders.AmqpResourceBuilder in AmqpProvider:(16):[amqp://localhost:5672] 
Open of resource:(JmsConnectionInfo { ID::0c95f1fa-a963-4caf-b709-05d52b840b4e:25, configuredURI = amqp://localhost:5672, connectedURI = null }) failed: Request to open resource AmqpConnection { ID::0c95f1fa-a963-4caf-b709-05d52b840b4e:25 } timed out

2016-08-17 16:25:32,079 - [INFO] - from org.mongodb.driver.connection in cluster-ClusterId{value='57b473040476172316fde1ff', description='null'}-localhost:27017 
Opened connection [connectionId{localValue:163, serverValue:1}] to localhost:27017

2016-08-17 16:25:32,081 - [INFO] - from org.mongodb.driver.cluster in cluster-ClusterId{value='57b473040476172316fde1ff', description='null'}-localhost:27017 
Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketReadException: Prematurely reached end of stream
	at com.mongodb.connection.SocketStream.read(SocketStream.java:88) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:491) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.receiveMessage(InternalStreamConnection.java:221) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.receiveReply(CommandHelper.java:134) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.receiveCommandResult(CommandHelper.java:121) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.CommandHelper.executeCommand(CommandHelper.java:32) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnectionInitializer.initializeConnectionDescription(InternalStreamConnectionInitializer.java:83) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnectionInitializer.initialize(InternalStreamConnectionInitializer.java:43) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115) ~[mongo-java-driver-3.0.1.jar:na]
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:127) ~[mongo-java-driver-3.0.1.jar:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]

2016-08-17 16:25:32,082 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Closed connection [connectionId{localValue:4, serverValue:21}] to localhost:27017 because there was a socket exception raised on another connection from this pool.

2016-08-17 16:25:32,083 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Closed connection [connectionId{localValue:2, serverValue:19}] to localhost:27017 because there was a socket exception raised on another connection from this pool.

2016-08-17 16:25:32,094 - [INFO] - from org.mongodb.driver.connection in play-akka.actor.default-dispatcher-6 
Opened connection [connectionId{localValue:164, serverValue:2}] to localhost:27017

2016-08-17 16:25:37,756 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:25:37,757 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443927757
 AND timestamp <= 1471443937757 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:25:37,776 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":1.0828688617948017}]

2016-08-17 16:25:37,776 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443937776,"Terms":{"_id":null,"metric":1.0828688617948017}}

2016-08-17 16:25:47,870 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:25:47,871 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443937871
 AND timestamp <= 1471443947871 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:25:47,875 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":0.48600486614600336}]

2016-08-17 16:25:47,876 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443947875,"Terms":{"_id":null,"metric":0.48600486614600336}}

2016-08-17 16:25:57,907 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:25:57,908 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443947908
 AND timestamp <= 1471443957908 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:25:57,912 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":0.32301712399147176}]

2016-08-17 16:25:57,912 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443957912,"Terms":{"_id":null,"metric":0.32301712399147176}}

2016-08-17 16:26:07,953 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:26:07,953 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443957953
 AND timestamp <= 1471443967953 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:26:07,957 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":0.18995001853728477}]

2016-08-17 16:26:07,957 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443967957,"Terms":{"_id":null,"metric":0.18995001853728477}}

2016-08-17 16:26:17,994 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:26:17,995 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443967995
 AND timestamp <= 1471443977995 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:26:17,998 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":0.2373246754115959}]

2016-08-17 16:26:17,999 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443977999,"Terms":{"_id":null,"metric":0.2373246754115959}}

2016-08-17 16:26:28,039 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:26:28,039 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443978039
 AND timestamp <= 1471443988039 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:26:28,044 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":1.0123427166271548}]

2016-08-17 16:26:28,045 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443988045,"Terms":{"_id":null,"metric":1.0123427166271548}}

2016-08-17 16:26:38,086 - [DEBUG] - from application in Thread-4 
Time to send notification for AppMeasuresNotifier{appId='SinusApp', deploymentId='null', slaId='xxx', terms=[metric], frequency=10000, queryHead='FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' ', queryTail=' GROUP BY NOTHING avg(data.metric) as metric', topicName='application-monitor.monitoring.SinusApp.measurement', removeOn=1471530133189}

2016-08-17 16:26:38,086 - [DEBUG] - from application in Thread-4 
Sending query to aggregation framework:
FROM events MATCH 
appId = 'SinusApp' 
AND slaId = 'xxx' 
 AND timestamp > 1471443988086
 AND timestamp <= 1471443998086 GROUP BY NOTHING avg(data.metric) as metric

2016-08-17 16:26:38,089 - [DEBUG] - from application in Thread-4 
Received: [{"_id":null,"metric":1.6447531390051051}]

2016-08-17 16:26:38,089 - [DEBUG] - from application in Thread-4 
Sending periodic notification: {"ApplicationId":"SinusApp","SlaId":"xxx","Timestamp":1471443998089,"Terms":{"_id":null,"metric":1.6447531390051051}}

2016-08-17 16:26:46,827 - [DEBUG] - from application in pool-4-thread-1 
Closing client database connection: Mongo{options=MongoClientOptions{description='null', readPreference=primary, writeConcern=WriteConcern{w=1, wtimeout=0, fsync=false, j=false, codecRegistry=org.bson.codecs.configuration.ProvidersCodecRegistry@4d2fb91a, minConnectionsPerHost=0, maxConnectionsPerHost=100, threadsAllowedToBlockForConnectionMultiplier=5, serverSelectionTimeout=30000, maxWaitTime=120000, maxConnectionIdleTime=0, maxConnectionLifeTime=0, connectTimeout=10000, socketTimeout=0, socketKeepAlive=false, sslEnabled=false, sslInvalidHostNamesAllowed=false, alwaysUseMBeans=false, heartbeatFrequency=10000, minHeartbeatFrequency=500, heartbeatConnectTimeout=20000, heartbeatSocketTimeout=20000, localThreshold=15, requiredReplicaSetName='null', dbDecoderFactory=com.mongodb.DefaultDBDecoder$1@7aaf8ccc, dbEncoderFactory=com.mongodb.DefaultDBEncoder$1@63582c1a, socketFactory=javax.net.DefaultSocketFactory@1b9eef5b, cursorFinalizerEnabled=true, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitQueueSize=500, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, keepAlive=false, receiveBufferSize=0, sendBufferSize=0}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=20000, readTimeoutMS=20000, keepAlive=false, receiveBufferSize=0, sendBufferSize=0}}}

2016-08-17 16:26:46,830 - [INFO] - from org.mongodb.driver.connection in pool-4-thread-1 
Closed connection [connectionId{localValue:164, serverValue:2}] to localhost:27017 because the pool has been closed.

2016-08-17 16:26:46,831 - [DEBUG] - from javax.management.mbeanserver in pool-4-thread-1 
 name = org.mongodb.driver:type=ConnectionPool,clusterId=57b473040476172316fde1ff,host=localhost,port=27017

2016-08-17 16:26:46,832 - [DEBUG] - from javax.management.mbeanserver in pool-4-thread-1 
name = org.mongodb.driver:type=ConnectionPool,clusterId=57b473040476172316fde1ff,host=localhost,port=27017

2016-08-17 16:26:46,832 - [DEBUG] - from javax.management.mbeanserver in pool-4-thread-1 
name = org.mongodb.driver:type=ConnectionPool,clusterId=57b473040476172316fde1ff,host=localhost,port=27017

2016-08-17 16:26:46,833 - [DEBUG] - from javax.management.mbeanserver in pool-4-thread-1 
Send delete notification of object org.mongodb.driver:clusterId=57b473040476172316fde1ff,host=localhost,port=27017,type=ConnectionPool

2016-08-17 16:26:46,833 - [DEBUG] - from javax.management.mbeanserver in pool-4-thread-1 
JMX.mbean.unregistered org.mongodb.driver:type=ConnectionPool,clusterId=57b473040476172316fde1ff,host=localhost,port=27017

2016-08-17 16:26:46,837 - [DEBUG] - from application in Thread-3 
While closing MessageDispatcher: null
java.lang.NullPointerException: null
	at es.bsc.amon.mq.MQManager$CommandTopicMessageDispatcher.run(MQManager.java:150) ~[na:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77]

2016-08-17 16:26:46,849 - [INFO] - from application in Thread-3 
MessageDispatcher successfully finished...

2016-08-17 16:26:46,872 - [DEBUG] - from application in pool-4-thread-1 
Stopped previously stablished connection, if any

